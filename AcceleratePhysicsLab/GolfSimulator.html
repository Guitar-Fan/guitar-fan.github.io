<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Swing Simulator - Double Pendulum Physics</title>
    
    <!-- Eruda Debug Console -->
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script>eruda.init();</script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Three.js and Physics -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <style>
        :root {
            --primary-bg: #0a0e1a;
            --secondary-bg: #1a2332;
            --accent-color: #00d4ff;
            --accent-secondary: #ff6b6b;
            --text-primary: #ffffff;
            --text-secondary: #b3c5d1;
            --success-color: #4ecdc4;
            --warning-color: #feca57;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--primary-bg) 0%, #0f1419 50%, #1a0f2e 100%);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
        }

        /* Main Layout - Full Screen Simulation */
        .main-container {
            display: grid;
            grid-template-columns: 280px 1fr 350px;
            height: 100vh;
        }

        /* Left Control Panel */
        .control-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 1.5rem;
            overflow-y: auto;
            z-index: 100;
        }

        .panel-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: 1.5rem;
            text-align: center;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
        }

        .control-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--glass-border);
        }

        /* Angle Control */
        .angle-control {
            margin-bottom: 1.5rem;
        }

        .angle-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .angle-value {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-color);
            font-weight: 500;
        }

        .angle-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--secondary-bg);
            outline: none;
            border: none;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .angle-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        .angle-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        /* Force Input */
        .force-input-group {
            margin-bottom: 1.5rem;
        }

        .force-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            background: var(--secondary-bg);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .force-input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.2);
        }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
        }

        .btn-primary {
            background: var(--accent-color);
            color: var(--primary-bg);
        }

        .btn-primary:hover {
            background: #00b8e6;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--secondary-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: var(--glass-bg);
            border-color: var(--accent-color);
        }

        .btn-success {
            background: var(--success-color);
            color: var(--primary-bg);
        }

        .btn-success:hover {
            background: #45b7aa;
        }

        /* Ball Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .stat-item {
            background: var(--secondary-bg);
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            padding: 0.75rem;
            text-align: center;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--accent-color);
        }

        /* Simulation Viewport - Full Screen */
        .simulation-viewport {
            position: relative;
            background: linear-gradient(135deg, #001122 0%, #002244 50%, #001133 100%);
            overflow: hidden;
        }

        #threejs-container {
            width: 100%;
            height: 100%;
        }

        .viewport-overlay {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 1rem;
            min-width: 200px;
        }

        .overlay-title {
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .overlay-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Loading Indicator */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: var(--accent-color);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--glass-border);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
            }

            .control-panel {
                height: auto;
                max-height: 40vh;
                border-right: none;
                border-bottom: 1px solid var(--glass-border);
            }
        }
    </style>
</head>

<body>
    <div class="main-container">
        <!-- Left Control Panel -->
        <div class="control-panel">
            <div class="panel-title">üèåÔ∏è Golf Simulator</div>
            
            <!-- Pendulum Angle Controls -->
            <div class="control-section">
                <div class="section-title">Pendulum Angles</div>
                
                <div class="angle-control">
                    <div class="angle-label">
                        <span>Arm Angle (¬∞)</span>
                        <span class="angle-value" id="arm-angle-value">0</span>
                    </div>
                    <input type="range" class="angle-slider" id="arm-angle-slider" 
                           min="-90" max="90" value="0" step="1">
                </div>
                
                <div class="angle-control">
                    <div class="angle-label">
                        <span>Club Angle (¬∞)</span>
                        <span class="angle-value" id="club-angle-value">0</span>
                    </div>
                    <input type="range" class="angle-slider" id="club-angle-slider" 
                           min="-180" max="180" value="0" step="1">
                </div>
            </div>

            <!-- Force Input -->
            <div class="control-section">
                <div class="section-title">Swing Force</div>
                
                <div class="force-input-group">
                    <label class="angle-label">
                        <span>Force (N)</span>
                    </label>
                    <input type="number" class="force-input" id="swing-force" 
                           placeholder="Enter force (0-1000)" value="500" min="0" max="1000">
                </div>
                
                <button class="btn btn-primary" id="swing-btn">üèåÔ∏è Swing!</button>
                <button class="btn btn-secondary" id="reset-btn">üîÑ Reset</button>
                <button class="btn btn-secondary" id="equations-btn">üìä Show Equations</button>
            </div>

            <!-- Ball Flight Stats -->
            <div class="control-section">
                <div class="section-title">Ball Flight Data</div>
                
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">Distance</div>
                        <div class="stat-value" id="ball-distance">0 m</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Max Height</div>
                        <div class="stat-value" id="ball-height">0 m</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Club Speed</div>
                        <div class="stat-value" id="club-speed">0 m/s</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Efficiency</div>
                        <div class="stat-value" id="efficiency">0%</div>
                    </div>
                </div>
                
                <div class="stat-item" style="margin-top: 1rem;">
                    <div class="stat-label">Ball Speed</div>
                    <div class="stat-value" id="ball-speed">0 m/s</div>
                </div>
                
                <div class="stats-grid" style="margin-top: 1rem;">
                    <div class="stat-item">
                        <div class="stat-label">Bounces</div>
                        <div class="stat-value" id="bounce-count">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Roll Distance</div>
                        <div class="stat-value" id="roll-distance">0 m</div>
                    </div>
                </div>
            </div>

            <!-- Physics Parameters -->
            <div class="control-section">
                <div class="section-title">Physics Settings</div>
                
                <div class="angle-control">
                    <div class="angle-label">
                        <span>Damping</span>
                        <span class="angle-value" id="damping-value">0.05</span>
                    </div>
                    <input type="range" class="angle-slider" id="damping-slider" 
                           min="0.01" max="0.2" value="0.05" step="0.01">
                </div>
                
                <div class="angle-control">
                    <div class="angle-label">
                        <span>Ball Bounce (COR)</span>
                        <span class="angle-value" id="bounce-value">0.8</span>
                    </div>
                    <input type="range" class="angle-slider" id="bounce-slider" 
                           min="0.3" max="0.95" value="0.8" step="0.05">
                </div>
                
                <div class="angle-control">
                    <div class="angle-label">
                        <span>Ground Friction</span>
                        <span class="angle-value" id="friction-value">0.3</span>
                    </div>
                    <input type="range" class="angle-slider" id="friction-slider" 
                           min="0.1" max="0.8" value="0.3" step="0.1">
                </div>
            </div>
        </div>

        <!-- Full Screen Simulation Viewport -->
        <div class="simulation-viewport">
            <div id="threejs-container">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div>Loading Golf Simulator...</div>
                </div>
            </div>
            
            <div class="viewport-overlay" style="
                background: rgba(10, 14, 26, 0.9);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(0, 212, 255, 0.3);
                box-shadow: 0 8px 32px rgba(0, 212, 255, 0.1);
            ">
                <div class="overlay-title" style="color: #00d4ff; font-weight: 600;">Golf Swing Physics</div>
                <div class="overlay-description" style="color: #ffffff; line-height: 1.5;">
                    Adjust the arm and club angles on the left, set your swing force, 
                    and watch how the double pendulum mechanics affect ball trajectory. 
                    The simulation shows realistic golf physics with fixed club dimensions (arm: 0.6m, club: 0.8m) 
                    including ball flight, bouncing, and rolling mechanics.
                </div>
            </div>
            
            <!-- Physics Equations Overlay -->
            <div class="physics-equations" id="physics-equations" style="
                position: absolute;
                bottom: 1rem;
                left: 1rem;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                border: 1px solid var(--glass-border);
                border-radius: 8px;
                padding: 1rem;
                font-family: 'JetBrains Mono', monospace;
                font-size: 0.7rem;
                color: var(--text-secondary);
                max-width: 400px;
                display: none;
            ">
                <div style="color: var(--accent-color); font-weight: 600; margin-bottom: 0.5rem;">
                    üßÆ Active Physics Equations
                </div>
                <div id="equation-content">
                    <!-- Dynamic equation content -->
                </div>
            </div>
        </div>
        
        <!-- Right Panel - 2D Trajectory View & Stats -->
        <div class="analysis-panel" style="
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-left: 1px solid var(--glass-border);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        ">
            <!-- 2D Trajectory Canvas -->
            <div style="padding: 1rem; border-bottom: 1px solid var(--glass-border);">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-color); margin-bottom: 0.5rem; text-align: center;">
                    üìä 2D Trajectory View
                </div>
                <canvas id="trajectory-canvas" width="636" height="400" style="
                    width: 100%;
                    height: auto;
                    background: rgba(0, 0, 0, 0.3);
                    border-radius: 6px;
                    border: 1px solid var(--glass-border);
                    display: block;
                "></canvas>
            </div>
            
            <!-- Shot Statistics -->
            <div style="padding: 1rem; border-bottom: 1px solid var(--glass-border);">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-color); margin-bottom: 0.75rem;">
                    üìà Current Shot Stats
                </div>
                <div id="shot-stats" style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; line-height: 1.6;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                        <div>
                            <div style="color: var(--text-secondary);">Carry Distance</div>
                            <div style="color: var(--accent-color); font-weight: 600;" id="stat-carry">0 m</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Total Distance</div>
                            <div style="color: var(--accent-color); font-weight: 600;" id="stat-total">0 m</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Max Height</div>
                            <div style="color: var(--success-color); font-weight: 600;" id="stat-height">0 m</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Ball Speed</div>
                            <div style="color: var(--success-color); font-weight: 600;" id="stat-speed">0 m/s</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Launch Angle</div>
                            <div style="color: var(--warning-color); font-weight: 600;" id="stat-launch">0¬∞</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Hang Time</div>
                            <div style="color: var(--warning-color); font-weight: 600;" id="stat-hangtime">0 s</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Spin Rate</div>
                            <div style="color: #ff6b6b; font-weight: 600;" id="stat-spin">0 rpm</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Smash Factor</div>
                            <div style="color: #ff6b6b; font-weight: 600;" id="stat-smash">0.0</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Club Selection -->
            <div style="padding: 1rem; border-bottom: 1px solid var(--glass-border);">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-color); margin-bottom: 0.75rem;">
                    üèåÔ∏è Club Selection
                </div>
                <select id="club-select" style="
                    width: 100%;
                    padding: 0.6rem;
                    background: var(--secondary-bg);
                    color: var(--text-primary);
                    border: 1px solid var(--glass-border);
                    border-radius: 6px;
                    font-size: 0.85rem;
                    cursor: pointer;
                ">
                    <option value="driver">Driver (10.5¬∞ loft)</option>
                    <option value="3wood">3 Wood (15¬∞ loft)</option>
                    <option value="5wood">5 Wood (18¬∞ loft)</option>
                    <option value="3iron">3 Iron (21¬∞ loft)</option>
                    <option value="5iron">5 Iron (27¬∞ loft)</option>
                    <option value="7iron" selected>7 Iron (34¬∞ loft)</option>
                    <option value="9iron">9 Iron (41¬∞ loft)</option>
                    <option value="pw">Pitching Wedge (48¬∞ loft)</option>
                    <option value="sw">Sand Wedge (56¬∞ loft)</option>
                </select>
                <div id="club-info" style="
                    margin-top: 0.5rem;
                    padding: 0.5rem;
                    background: rgba(0, 212, 255, 0.1);
                    border-radius: 4px;
                    font-size: 0.7rem;
                    line-height: 1.4;
                ">
                    <div>Length: <span id="club-length">1.0m</span></div>
                    <div>Loft: <span id="club-loft">34¬∞</span></div>
                    <div>Ideal Distance: <span id="club-distance">140-155m</span></div>
                </div>
            </div>
            
            <!-- Wind Controls -->
            <div style="padding: 1rem; border-bottom: 1px solid var(--glass-border);">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-color); margin-bottom: 0.75rem;">
                    üí® Wind Conditions
                </div>
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>Wind Speed</span>
                        <span style="color: var(--accent-color); font-family: 'JetBrains Mono', monospace;" id="wind-speed-value">0 m/s</span>
                    </div>
                    <input type="range" class="angle-slider" id="wind-speed" 
                           min="0" max="15" value="0" step="0.5">
                </div>
                <div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem; font-size: 0.85rem;">
                        <span>Wind Direction</span>
                        <span style="color: var(--accent-color); font-family: 'JetBrains Mono', monospace;" id="wind-dir-value">0¬∞</span>
                    </div>
                    <input type="range" class="angle-slider" id="wind-direction" 
                           min="0" max="360" value="0" step="15">
                    <div style="margin-top: 0.3rem; font-size: 0.7rem; color: var(--text-secondary);">
                        0¬∞ = Tailwind, 90¬∞ = Left to Right, 180¬∞ = Headwind, 270¬∞ = Right to Left
                    </div>
                </div>
            </div>
            
            <!-- Shot History -->
            <div style="padding: 1rem; flex: 1; overflow-y: auto;">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-color); margin-bottom: 0.75rem;">
                    üìú Shot History
                </div>
                <div id="shot-history" style="font-size: 0.75rem; font-family: 'JetBrains Mono', monospace;">
                    <div style="color: var(--text-secondary); text-align: center; padding: 1rem;">
                        No shots recorded yet
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="window.golfSimulator.clearHistory()" style="margin-top: 0.5rem; font-size: 0.8rem;">
                    Clear History
                </button>
            </div>
        </div>
    </div>

    <script src="golf-simulator.js"></script>
</body>
</html>